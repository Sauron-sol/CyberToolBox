# Malware Analysis Sandbox ðŸ”¬

A secure sandbox environment for analyzing potentially malicious files.

## Features

- **Static Analysis**
  - File type detection
  - Hash calculation (MD5, SHA1, SHA256)
  - YARA rules scanning
  - String extraction
  - VirusTotal integration

- **Dynamic Analysis**
  - Process monitoring
  - Network activity tracking
  - File system operations monitoring
  - Registry changes detection
  - Memory analysis

- **Cross-Platform Support**
  - Windows VM analysis
  - Linux VM analysis
  - MacOS VM analysis

- **Reporting**
  - Detailed HTML reports
  - JSON export
  - Risk score calculation
  - IoC extraction

## Installation

```bash
# Create virtual environment
python3 -m venv venv
source venv/bin/activate  # or `venv\Scripts\activate` on Windows

# Install dependencies
pip install -r requirements.txt

# Setup environment
./setup.sh  # or setup.bat on Windows
```

## Configuration

1. Copy `config/sandbox_config.example.py` to `config/sandbox_config.py`
2. Add your VirusTotal API key to `.env`:
```bash
VT_API_KEY=your_key_here
```
3. Configure VM settings if needed

## Usage

### Command Line
```bash
# Basic file analysis
python main.py analyze path/to/file

# Run tests
python -m tests.test_sandbox     # Basic test
python -m tests.test_malicious  # Malicious sample test
```

### Python API
```python
from core.analyzer import MalwareAnalyzer
from core.reporter import SandboxReporter
from config.sandbox_config import SandboxConfig

async def analyze_file(file_path):
    # Initialize components
    analyzer = MalwareAnalyzer()
    reporter = SandboxReporter(SandboxConfig)
    
    # Analyze file
    results = await analyzer.analyze_sample(file_path)
    
    # Generate report
    sample_info = {
        'filename': Path(file_path).name,
        'size': Path(file_path).stat().st_size,
        'path': file_path
    }
    report = await reporter.generate_report(results, sample_info)
    
    print(f"Analysis complete. Risk score: {report['risk_score']}/100")
    print(f"Reports saved to: {report['html_path']}")
```

### Web Interface
```bash
# Start the web server
uvicorn main:app --reload --port 8000
```
Then visit `http://localhost:8000` in your browser.

## Security Notes

- Never analyze malware on production systems
- Use isolated virtual environments
- Keep API keys secure
- Follow responsible disclosure practices
- Regularly update YARA rules
- Monitor VM resource usage

## Project Structure
```
Malware_sandbox/
â”œâ”€â”€ config/           # Configuration files
â”œâ”€â”€ core/             # Core analysis modules
â”œâ”€â”€ rules/            # YARA rules
â”œâ”€â”€ templates/        # Report templates
â”œâ”€â”€ tests/            # Test files
â””â”€â”€ utils/            # Utility functions
```

## Testing

```bash
# Run all tests
python -m pytest

# Run specific test
python -m tests.test_sandbox
python -m tests.test_malicious
```

## Acknowledgments

- VirusTotal API
- YARA Project
- Sandbox Community